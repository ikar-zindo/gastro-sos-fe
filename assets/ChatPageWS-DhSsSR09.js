import{R as h,j as s,a as u,s as f,b as M,c as j,r as i,f as C,g as I,d as T,e as v,h as A}from"./index-LMPbKw68.js";import{M as S,s as _}from"./MessageTextarea-CdCfv7i6.js";import{a as R}from"./dialogs-selectors-DT3n6bma.js";const b="_groupChat_1oex9_1",k="_groupChatMessages_1oex9_9",p={groupChat:b,groupChatMessages:k},V=h.memo(()=>s.jsx("div",{className:p.groupChat,children:s.jsx(E,{})})),E=()=>{const t=u(R),n=u(f);let{userId:c}=M();const o=j(),l=t.messageValue,a=t.placeholder,e=t.dialogs.find(r=>r.id===parseInt(c||"0")),d=n.find(r=>r.userId===(e==null?void 0:e.participants[0].userId)),g=n.find(r=>r.userId===(e==null?void 0:e.participants[1].userId));i.useEffect(()=>(o(C()),()=>{o(I())}),[]);const x=r=>{o(T(r))},m=()=>{if(l.text&&d&&g){const r={senderId:d.userId,receiverId:g.userId};o(v(r)),o(A(l.text))}};return s.jsxs(s.Fragment,{children:[s.jsx(P,{}),s.jsx(S,{placeholder:a,value:l,handleChange:x,handleClick:m})]})},P=()=>{const t=u(_),n=i.useRef(null),[c,o]=i.useState(!0),l=a=>{let e=a.currentTarget;Math.abs(e.scrollHeight-e.scrollTop-e.clientHeight)<100?!c&&o(!0):c&&o(!1)};return i.useEffect(()=>{var a;c&&((a=n.current)==null||a.scrollIntoView({behavior:"smooth"}))},[t]),s.jsxs("div",{className:p.groupChatMessages,onScroll:l,children:[t.map(a=>s.jsx(w,{message:a},a.id)),s.jsx("div",{ref:n})]})},w=h.memo(({message:t})=>s.jsxs("div",{children:[s.jsx("img",{src:t.photo,style:{width:"30px"},alt:"photo"}),s.jsx("br",{}),t.message,s.jsx("hr",{})]}));export{V as default};
